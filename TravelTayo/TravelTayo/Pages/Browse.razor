@page "/browse"
@layout MainLayout




<div class="container py-5">
    <h2 class="text-center fw-bold text-primary">Family Travel Deals</h2>
    <p class="text-center text-muted mb-4">
        Discover hotels, resorts, and family-friendly destinations with TravelTayo. Explore curated listings for unforgettable family trips.
    </p>

    <!-- Search / Filters -->
    <div class="row mb-4 justify-content-center g-2">
        <!-- Search -->
        <div class="col-md-4">
            <input type="text" class="form-control" placeholder="Search hotels..." @bind="searchQuery" @bind:event="oninput" />
        </div>

        <!-- Destination Filter -->
        <div class="col-md-3">
            <select class="form-select" @bind="selectedDestination">
                <option value="">All Destinations</option>
                @foreach (var dest in destinations)
                {
                    <option value="@dest">@dest</option>
                }
            </select>
        </div>

        <!-- Minimum Rating Filter -->
        <div class="col-md-2">
            <select class="form-select" @bind="selectedMinRating">
                <option value="">Any Rating</option>
                @for (int i = 1; i <= 5; i++)
                {
                    <option value="@i">@i ⭐ & Up</option>
                }
            </select>
        </div>
    </div>

    <!-- Hotel Listings -->
    <!-- Hotel Listings -->
    <div class="row row-cols-1 row-cols-md-3 g-4">
        @foreach (var hotel in filteredHotels)
        {
            <div class="col animate__animated animate__fadeInUp animate__repeat-1" style="animation-duration: .8s; animation-delay: .2s;">
                <div class="card h-100 shadow-sm position-relative">
                    <img src="@hotel.ImageUrl" class="card-img-top" alt="@hotel.Name - Family Travel Destination" style="height: 200px; object-fit: cover;" />

                    <!-- Badges -->
                    @if (hotel.Rating >= 4.5)
                    {
                        <span class="badge bg-success position-absolute top-0 start-0 m-2">Highly Rated</span>
                    }
                    @if (hotel.ReviewCount >= 100)
                    {
                        <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2">Popular</span>
                    }

                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title fw-bold">@hotel.Name</h5>
                        <p class="text-muted mb-2">@hotel.Description</p>

                        @if (hotel.Rating.HasValue)
                        {
                            <p class="mb-2">
                                @for (int i = 1; i <= 5; i++)
                                {
                                    <i class="bi @(i <= Math.Round(hotel.Rating.Value) ? "bi-star-fill text-warning" : "bi-star")"></i>
                                }
                                (@hotel.ReviewCount reviews)
                            </p>
                        }

                        <p class="mb-3"><strong>Destination:</strong> @hotel.Destination</p>

                        <!-- ✅ Updated CTA without Agoda -->
                        <a href="/booking" class="mt-auto btn btn-primary">Inquire / Book</a>
                    </div>
                </div>
            </div>
        }
    </div>

</div>

@code {
    private string searchQuery = "";
    private string selectedDestination = "";
    private int? selectedMinRating = null;

    private List<string> destinations => sampleHotels.Select(h => h.Destination).Distinct().ToList();

    private List<Hotel> filteredHotels => sampleHotels
        .Where(h => (string.IsNullOrWhiteSpace(searchQuery)
                        || h.Name.Contains(searchQuery, StringComparison.OrdinalIgnoreCase)
                        || h.Description.Contains(searchQuery, StringComparison.OrdinalIgnoreCase))
                    && (string.IsNullOrWhiteSpace(selectedDestination)
                        || h.Destination == selectedDestination)
                    && (!selectedMinRating.HasValue
                        || (h.Rating.HasValue && h.Rating.Value >= selectedMinRating.Value))
        ).ToList();

    private List<Hotel> sampleHotels = new()
    {
        new Hotel { Name="Boracay Hotels", Description="Beachfront rooms, kids’ pool, guided island tours.", ImageUrl="/images/hotelboracay.jpg", Destination="Boracay, Philippines", AgodaAffiliateLink="https://www.agoda.com/search?city=15903&locale=en-us&ckuid=87be91e0-652f-41e9-ae77-b4b3b64b41f0&prid=0&currency=PHP&correlationId=2d39570c-5a1b-4d9b-819c-95db2562f957&analyticsSessionId=-475056827503701194&pageTypeId=103&realLanguageId=1&languageId=1&origin=PH&stateCode=NUE&cid=1908612&userId=87be91e0-652f-41e9-ae77-b4b3b64b41f0&whitelabelid=1&loginLvl=0&storefrontId=3&currencyId=18&currencyCode=PHP&htmlLanguage=en-us&cultureInfoName=en-us&machineName=hk-pc-2f-acm-web-user-8474fc875d-zzwsv&trafficGroupId=4&sessionId=0pozvzdrn30phzbnhrn0ej2o&trafficSubGroupId=849&aid=296180&useFullPageLogin=true&cttp=4&isRealUser=true&mode=production&browserFamily=Edge+%28Chromium%29+for+Windows&cdnDomain=agoda.net&checkIn=2024-12-28&checkOut=2025-01-02&rooms=1&adults=2&children=3&childages=8%2C6%2C10&priceCur=PHP&los=5&textToSearch=Boracay+Island&travellerType=2&familyMode=off&ds=Du%2BWz5BEVMkBo%2BTG&productType=-1", Rating=4.5, ReviewCount=120 },
        new Hotel { Name="Tokyo Disneyland Hotels", Description="3 nights stay, park tickets included, family-friendly amenities.", ImageUrl="/images/hoteltokyodisneyland.jpg", Destination="Tokyo, Japan", AgodaAffiliateLink="https://www.agoda.com/search?guid=60d23b32-775d-4c03-b364-d5496e85e97e&asq=h83K5OpxMgwyDRBM%2B68DD5ufa9Vwpz6XltTHq4n%2B9gMIhr%2FHdI3Zp6E1hg81WRuFf2UbWfRAukQNb3dGyRKmtgZ21Z%2BQ0flvzVGSJ5CAztjBrr%2BBZr4%2FUCF11FETpPbX41eQys3gvwZJCwt8zgLoQ31CgyHhNV29NWUEu3I%2FAo2REo4auv6WpMGCg%2BhNzT43oRp%2B%2Bnl1iMK2R3bh%2FxZuhg%3D%3D&city=5085&tick=638945099332&locale=en-us&ckuid=c5c13c0c-ead5-4288-becb-4dca0458c352&prid=0&currency=PHP&correlationId=a7f65b5b-c26e-4937-8fc7-f43b37c229ab&analyticsSessionId=-883245238951808813&pageTypeId=103&realLanguageId=1&languageId=1&origin=PH&stateCode=00&cid=1908612&userId=c5c13c0c-ead5-4288-becb-4dca0458c352&whitelabelid=1&loginLvl=0&storefrontId=3&currencyId=18&currencyCode=PHP&htmlLanguage=en-us&cultureInfoName=en-us&machineName=hk-pc-2f-acm-web-user-6c965c746-r45dq&trafficGroupId=4&trafficSubGroupId=849&aid=296180&useFullPageLogin=true&cttp=4&isRealUser=true&mode=production&browserFamily=Chrome&cdnDomain=agoda.net&checkIn=2025-09-27&checkOut=2025-10-02&rooms=1&adults=2&children=3&childages=8%2C6%2C10&priceCur=PHP&los=5&textToSearch=Tokyo&travellerType=2&familyMode=off&ds=dXcXcfTa93rrYmcJ&productType=-1", Rating=4.7, ReviewCount=95 },
        new Hotel { Name="Baguio Hotels", Description="Cozy hilltop hotel, perfect for cool-weather family getaway.", ImageUrl="/images/hotelbaguio.jpg", Destination="Baguio, Philippines", AgodaAffiliateLink="https://www.agoda.com/search?guid=7609393d-e421-46a5-b0d0-8729ecb95bb4&asq=h83K5OpxMgwyDRBM%2B68DD5ufa9Vwpz6XltTHq4n%2B9gMIhr%2FHdI3Zp6E1hg81WRuF6CTb8t%2B92F6sgXmRXLdDByV8O1SzHJ7Bv9omVvB8VpWHUbckv5%2F3n2sEbwIG2uYsr6QDs48C6hOjLzuYUvlEgOm%2B3QacrQMDUE7JkJAfzu2dp8zVRkEGjhldTHN1TqoA1zCU%2BVxM95udogIPF84UrA%3D%3D&city=17196&tick=638945099601&locale=en-us&ckuid=85e939ed-5616-4e2f-a197-f33e869d2336&prid=0&currency=PHP&correlationId=10e3c2a2-bae7-4b61-8e43-9b7233ba4df6&analyticsSessionId=-735578938754471804&pageTypeId=103&realLanguageId=1&languageId=1&origin=PH&stateCode=00&cid=1908612&userId=85e939ed-5616-4e2f-a197-f33e869d2336&whitelabelid=1&loginLvl=0&storefrontId=3&currencyId=18&currencyCode=PHP&htmlLanguage=en-us&cultureInfoName=en-us&machineName=hk-pc-2i-acm-web-user-87f77c54d-hljhv&trafficGroupId=4&trafficSubGroupId=849&aid=296180&useFullPageLogin=true&cttp=4&isRealUser=true&mode=production&browserFamily=Edge+%28Chromium%29+for+Windows&cdnDomain=agoda.net&checkIn=2025-09-27&checkOut=2025-10-02&rooms=1&adults=2&children=3&childages=8%2C6%2C10&priceCur=PHP&los=5&textToSearch=Baguio&travellerType=2&familyMode=off&ds=Du%2BWz5BEVMkBo%2BTG&productType=-1", Rating=4.3, ReviewCount=78 },
        new Hotel { Name="Cebu Hotels", Description="Family-friendly beachfront hotel offering snorkeling trips and island hopping.", ImageUrl="/images/cebuhotels.jpg", Destination="Cebu, Philippines", AgodaAffiliateLink="https://www.agoda.com/search?guid=c2187ad1-9d1e-4f01-a0be-3c5e956ad0da&asq=h83K5OpxMgwyDRBM%2B68DD5ufa9Vwpz6XltTHq4n%2B9gMIhr%2FHdI3Zp6E1hg81WRuFAStvl45kWtgDPiW0nVagoI5G9YGAPld73Pr7JhE%2FSBlHF2zGu01fY4uKzFOqK%2FR7Bb%2BZ58XrzTZovriM0y21ppHmzxvaDqZeF7Dkxa68X06WhRSbJRAOtNQacOJDY%2BKdoRp%2B%2Bnl1iMK2R3bh%2FxZuhg%3D%3D&city=4001&tick=638945099826&locale=en-us&ckuid=85e939ed-5616-4e2f-a197-f33e869d2336&prid=0&currency=PHP&correlationId=c673e0a2-8fa4-4e93-8fb1-6d1851f18b2c&analyticsSessionId=-735578938754471804&pageTypeId=103&realLanguageId=1&languageId=1&origin=PH&stateCode=00&cid=1908612&userId=85e939ed-5616-4e2f-a197-f33e869d2336&whitelabelid=1&loginLvl=0&storefrontId=3&currencyId=18&currencyCode=PHP&htmlLanguage=en-us&cultureInfoName=en-us&machineName=hk-pc-2i-acm-web-user-87f77c54d-g6ph7&trafficGroupId=4&trafficSubGroupId=849&aid=296180&useFullPageLogin=true&cttp=4&isRealUser=true&mode=production&browserFamily=Edge+%28Chromium%29+for+Windows&cdnDomain=agoda.net&checkIn=2025-09-27&checkOut=2025-10-02&rooms=1&adults=2&children=3&childages=8%2C6%2C10&priceCur=PHP&los=5&textToSearch=Cebu&travellerType=2&familyMode=off&ds=Du%2BWz5BEVMkBo%2BTG&productType=-1", Rating=4.6, ReviewCount=110 },
    };

    private class Hotel
    {
        public string Name { get; set; } = "";
        public string Description { get; set; } = "";
        public string ImageUrl { get; set; } = "";
        public string AgodaAffiliateLink { get; set; } = "#";
        public string Destination { get; set; } = "";
        public double? Rating { get; set; } = null;
        public int? ReviewCount { get; set; } = null;
    }
}
